{\rtf1\ansi\ansicpg1252\cocoartf949\cocoasubrtf430
{\fonttbl\f0\fnil\fcharset0 Monaco;}
{\colortbl;\red255\green255\blue255;\red0\green0\blue191;\red0\green115\blue0;\red191\green0\blue0;
}
\deftab560
\pard\pardeftab560\ql\qnatural

\f0\fs18 \cf0 \
~grainbuflength = 10.0;\
~grainbuf = \cf2 Buffer\cf0 .alloc(s, s.sampleRate * ~grainbuflength, 1);\
\
~grainrec = \cf2 Synth\cf0 .new(\cf3 \\record_adc\cf0 , [\cf3 \\buf\cf0 , ~grainbuf.bufnum, \cf3 \\run\cf0 , 1]);\
~\cf4 //grainrec.set(\\thresh, 0.001);\cf0 \
\
\pard\pardeftab560\ql\qnatural
\cf4 //~grainsyn = Synth.after(~grainrec, \\tgraintest, [\\buf, ~grainbuf.bufnum]);\cf0 \
\
~grainsyn = \cf2 Synth\cf0 .after(~grainrec, \cf3 \\phasegrain\cf0 , [\cf3 \\buf\cf0 , ~grainbuf.bufnumm, \\pitchfrainsize, 0.25]);\
\
~grainsyn.set(\cf3 \\grainrate\cf0 , 20);\
~grainsyn.set(\cf3 \\graindur\cf0 , 25);\
~grainsyn.set(\cf3 \\posrate\cf0 , 0.002);\
~grainsyn.set(\cf3 \\phasemin\cf0 , 0.2);\
~grainsyn.set(\cf3 \\phasemax\cf0 , 0.8); \
\
~grainrec.set(\cf3 \\run\cf0 , 1);\
~grainrec.set(\cf3 \\run\cf0 , 0);\
\
~grainrec.run(\cf2 false\cf0 );\
~grainrec.run(\cf2 true\cf0 ;);\
\
\
~grainsyn.run(\cf2 false\cf0 );\
~grainsyn.run(\cf2 true\cf0 );\
\
~grainsyn.set(\cf3 \\pitch\cf0 , 0.25);\
\
~grainsyn.set(\cf3 \\level\cf0 , 0.5);\
\
~grainsyn.set(\cf3 \\release\cf0 , 0.0);\
~grainsyn.set(\cf3 \\gate\cf0 , 0);\
~grainsyn.set(\cf3 \\pitchgrainsize\cf0 , 0.5);\
\
\cf4 /*\
~grainsyn.free;\
*/\cf0 \
\
~grainsyn.set(\cf3 \\pitchpitch\cf0 , 3.0);\
~grainsyn.set(\cf3 \\pitchpitchblend\cf0 , 1.0);\
\
\
\cf4 /// 2nd voice\cf0 \
~gsyn2 = \cf2 Synth\cf0 .after(~grainrec, \cf3 \\phasegrain\cf0 , [\cf3 \\buf\cf0 , ~grainbuf.bufnum, \cf3 \\pitchgrainsize\cf0 , 2/7]);\
\
~gsyn2.set(\cf3 \\grainrate\cf0 , 20);\
~gsyn2.set(\cf3 \\graindur\cf0 , 25);\
~gsyn2.set(\cf3 \\posrate\cf0 , 1/17);\
~gsyn2.set(\cf3 \\phasemin\cf0 , 0.5);\
~gsyn2.set(\cf3 \\phasemax\cf0 , 0.7); \
~gsyn2.set(\cf3 \\level\cf0 , 0.5); \
\
\
//////\
~gsyn2.set(\cf3 \\pitch\cf0 , 9/13);\
~gsyn2.set(\cf3 \\pitchpitch\cf0 , 13/9);\
~gsyn2.set(\cf3 \\pitchpitchblend\cf0 , 1.0);\
\
\
\cf4 /// 3rd voice\cf0 \
~gsyn3 = \cf2 Synth\cf0 .after(~grainrec, \cf3 \\phasegrain\cf0 , [\cf3 \\buf\cf0 , ~grainbuf.bufnum, \\pitchgrainsize, 0.2]);\
\
~gsyn3.set(\cf3 \\grainrate\cf0 , 10);\
~gsyn3.set(\cf3 \\graindur\cf0 , 25);\
~gsyn3.set(\cf3 \\posrate\cf0 , 0.005);\
~gsyn3.set(\cf3 \\phasemin\cf0 , 0.1);\
~gsyn3.set(\cf3 \\phasemax\cf0 , 0.9); \
~gsyn3.set(\cf3 \\level\cf0 , 0.5); \
\
~gsyn3.set(\cf3 \\pitch\cf0 , 3/8);\
~gsyn3.set(\cf3 \\pitchpitch\cf0 , 8/3);\
~gsyn3.set(\cf3 \\pitchpitchblend\cf0 , 1.0);\
\
\
\
\
~grainbuf.write(\cf3 'whistle.aif'\cf0 );\
\pard\pardeftab560\ql\qnatural
\cf2 Buffer\cf0 \
\pard\pardeftab560\ql\qnatural
\cf4 /*\
\
\
~grainbuf.plot;\
~grainrec.free;\
~grainbuf.free;\
\
~grainsyn.free;\
\
\
*/\cf0 \
\
s.freeAll;}